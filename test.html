<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Konum Alma</title>
  <style>
    #status {
      font-size: 18px;
      color: #333;
    }
  </style>
</head>
<body>
  <div id="status">Konum alınmaya çalışılıyor...</div>

  <script>
    let statusElement = document.getElementById('status');
    let attempts = 0;

    // Konum alma fonksiyonu
    function getLocation(attempts) {
      if (attempts >= 5) {  // 5 deneme sonrası çık
        statusElement.innerText = "Konum alınamadı. Lütfen bağlantınızı kontrol edin.";
        return;
      }

      const options = {
        timeout: 10000, // 10 saniye zaman aşımı
        enableHighAccuracy: false, // Başlangıçta düşük doğruluk
      };

      if (attempts === 0) {
        statusElement.innerText = "Konum alınmaya çalışılıyor...";
      } else {
        statusElement.innerText = `Yüksek doğruluk ile tekrar deneme (${attempts})...`;
      }

      navigator.geolocation.getCurrentPosition(
        function(position) {
          // Başarılı konum alındığında
          let lat = position.coords.latitude;
          let lon = position.coords.longitude;
          statusElement.innerHTML = `Konum Alındı: <br>Lat: ${lat} <br>Lon: ${lon}`;
        },
        function(error) {
          if (error.code === error.TIMEOUT) {
            statusElement.innerText = "Zaman aşımı, tekrar denemeye çalışılıyor...";
            setTimeout(function() {
              getLocation(attempts + 1);  // Yeniden deneme
            }, 3000);  // 3 saniye sonra tekrar dene
          } else {
            statusElement.innerText = "Konum alınamadı: " + error.message;
          }
        },
        options
      );
    }

    // Başlangıçta konum almayı başlat
    getLocation(attempts);
  </script>
</body>
</html>
